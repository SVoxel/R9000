--- a/kernel/include/linux/netfilter/ipset/ip_set_compat.h.in	2019-11-01 18:13:11.000000000 +0300
+++ b/kernel/include/linux/netfilter/ipset/ip_set_compat.h.in	2020-04-15 13:53:21.342342000 +0300
@@ -82,6 +82,7 @@
 
 #include <linux/version.h>
 #include <linux/netlink.h>
+#include <linux/vmalloc.h>
 
 #ifdef HAVE_SYNCHRONIZE_RCU_BH
 #define synchronize_rcu()		synchronize_rcu_bh()
--- a/kernel/net/netfilter/ipset/ip_set_list_set.c	2019-11-01 18:13:11.000000000 +0300
+++ b/kernel/net/netfilter/ipset/ip_set_list_set.c	2020-04-15 13:53:21.349336500 +0300
@@ -277,7 +277,7 @@
 	if (d->before == 0) {
 		/* Append  */
 		n = list_empty(&map->members) ? NULL :
-		    list_last_entry(&map->members, struct set_elem, list);
+		    plist_last_entry(&map->members, struct set_elem, list);
 	} else if (d->before > 0) {
 		/* Insert after next element */
 		if (!list_is_last(&next->list, &map->members))
